function ebCTemplateBBanner(objName){this.temp=ebCBannerBase;this.temp();delete this.temp;var strFlashObjName="ebBannerFlash_";var strRichFlashName="ebRichFlash_";var strImageName="ebBannerImage_";var strBannerDiv="ebBannerDiv_";var browser=new ebCBrowserCheck();this.fRichFlashLoaded=false;this.fLoadRichFlashCalled=false;this.fRichFlashPlayed=false;this.objName=objName;this.fLoadRichOnPageLoad=false;this.fCloseable=false;this.addResources=addResources;this.loadRichFlash=loadRichFlash;this.isFlashLoaded=isFlashLoaded;this.showRichFlash=showRichFlash;this.doOnload=doOnload;this.doOnUnload=doOnUnload;this.replay=replay;this.addRes=addRes;this.getResOrigSize=getResOrigSize;this.getTemplateTrackedDiv=getTemplateTrackedDiv;this.updateTemplateInteractions=updateTemplateInteractions;this.getBannerRes=getBannerRes;this.checkElementId=checkElementId;this.ebloadrichflashHandler=loadRichFlashHandler;this.ebstartrichflashHandler=showRichFlashHandler;this.ebreplayHandler=ebReplayHandler;this.ebautoreplayHandler=ebAutoReplayHandler;this.ebloadrichbannerHandler=loadRichFlashHandler;this.ebshowrichbannerHandler=showRichFlashHandler;function addResources(){var strName=this.myName(strBannerDiv);var divAttr=new ebCTIObj(strName);divAttr.style.display="inline";var method="write";this.adTI.addDiv(method,divAttr);this.setBannerType();this.countDefaultImage();var fMSNIframe=((typeof(gfEbMSNIframe)!="undefined")&&gfEbMSNIframe);var strDomain;var strRichFlashID=this.myName(strRichFlashName);var strDefaultFlashID=this.myName(strFlashObjName);if(this.ad.strRichFlash!=""){this.ad.strRichFlash=this.buildResUrl(this.ad.strRichFlash,strRichFlashID,strDomain);if(gEbFlashVer<6)this.ad.strRichFlash+=this.buildFlashVars(strRichFlashID);}if(this.ad.strDefaultFlash!=""){this.ad.strDefaultFlash=this.buildResUrl(this.ad.strDefaultFlash,strDefaultFlashID,strDomain);if(gEbFlashVer<6)this.ad.strDefaultFlash+=this.buildFlashVars(strDefaultFlashID);}if(browser.isIE()){this.addRes();}else {if(browser.isSafari()&&(this.ad.strRichFlash!="")){var objName=strRichFlashID;var fsCommandhandler=this.scriptWin+"." + this.objName + ".handleFSCommand(command,args,'" + objName + "');";this.adTI.addFsCommandHandler("write",objName,fsCommandhandler);}var strFunc=this.objName+".addRes()";window.setTimeout(strFunc,100);}}function addRes(){this.adData.customEventHandler.onBeforeDefaultBannerShow(this.objName);if(this.fImageOnly){displayImage(this);return;}var method="append";var width=this.adData.nWidth;var height=this.adData.nHeight;var dlMode=parseInt(this.adData.nDownloadMode);switch(dlMode){case 1:if(this.objType==1)displayImage(this);else addFlash(this,method,strFlashObjName,this.ad.strDefaultFlash,true,"opaque",width,height);if(this.ad.strRichFlash!="")this.fLoadRichOnPageLoad=true;if(gEbDocLoaded)this.doOnload();break;case 2:case 3:if((this.ad.fPreloader)&&(this.ad.strRichFlash!="")){this.adData.customEventHandler.onBeforeRichFlashShow(this.objName);addFlash(this,method,strRichFlashName,this.ad.strRichFlash,true,"opaque",width,height);this.adData.customEventHandler.onAfterRichFlashShow(this.objName);this.ebsysteminteractionHandler("ebRichFlashPlayed");this.fLoadRichFlashCalled=true;this.fRichFlashPlayed=true;}else {if(this.objType==1)displayImage(this);else addFlash(this,method,strFlashObjName,this.ad.strDefaultFlash,true,"opaque",width,height);if(this.ad.strRichFlash!="")this.loadRichFlash(method);}break;}this.adData.customEventHandler.onAfterDefaultBannerShow(this.objName);}function loadRichFlash(method){if(this.fLoadRichFlashCalled)return;else this.fLoadRichFlashCalled=true;addFlash(this,method,strRichFlashName,this.ad.strRichFlash,false,"opaque",0,0);this.showRichFlash();}function isFlashLoaded(){try{var strName=this.myName(strRichFlashName);var flashobj=this.adTI.getDoc().getElementById(strName);if(flashobj==null){this.loadRichFlash('append');return false;}this.fRichFlashLoaded=this.flashResReady(flashobj,this.ad.nRichFlashWeight,this.ad.RichFlashStreaming);return (this.fRichFlashLoaded);}catch(e){return false;}}function showRichFlash(commandFromFlash){if(typeof(commandFromFlash)=='undefined')commandFromFlash=false;if(this.fRichFlashPlayed){return;}if(this.isFlashLoaded()){if((this.objType!=1)&&this.ad.fWaitForFlashCommand&&!commandFromFlash){return;}this.adData.customEventHandler.onBeforeRichFlashShow(this.objName);switchToRich(this);this.adData.customEventHandler.onAfterRichFlashShow(this.objName);this.ebsysteminteractionHandler("ebRichFlashPlayed");this.fRichFlashPlayed=true;}else {if(this.ad.fWaitForFlashCommand){return;}else {window.setTimeout(this.objName+". showRichFlash();",100);return;}}}function doOnload(){if(this.fLoadRichOnPageLoad)this.loadRichFlash('append');}function doOnUnload(){if(typeof(gEbSyncAdsRes)!="undefined"){var adIdentifier=this.objName;gEbSyncAdsRes.clear(this.getBannerRes(),adIdentifier,this.adData.nCampaignID);}if(gfEbMSNAjax)gEbDisplayPage.close();}function getResOrigSize(resObj){var strRich=this.myName(strRichFlashName);var strDefault=this.myName(strFlashObjName);var arrSize=new Array();switch(resObj.id){case strRich:arrSize[0]=this.ad.nRichFlashWidth;arrSize[1]=this.ad.nRichFlashHeight;break;case strDefault:arrSize[0]=this.ad.nDefaultFlashWidth;arrSize[1]=this.ad.nDefaultFlashHeight;break;default:return null;}return arrSize;}function getTemplateTrackedDiv(resObj){var trackedDiv=null;if(resObj==this.getBannerRes()){var strName=this.myName(strBannerDiv);trackedDiv=this.adTI.getDoc().getElementById(strName);}return trackedDiv;}function updateTemplateInteractions(){var interactions=this.interactions;var attr="ebRichFlashPlayed";var lowerAttr=attr.toLowerCase();var inter=new ebCInteraction(attr);inter.fCloseFlag=0;inter.fCountAsClick=0;inter.nCategory=2;interactions[lowerAttr]=inter;}function loadRichFlashHandler(){this.loadRichFlash('append');}function showRichFlashHandler(){this.showRichFlash(true);}function ebReplayHandler(){try{window.setTimeout(this.objName+".replay()",50);this.ebsysteminteractionHandler("ebReplay");}catch(e){}}function ebAutoReplayHandler(){try{window.setTimeout(this.objName+".replay()",50);}catch(e){}}function getBannerRes(){var strName="";if(this.fLoadRichFlashCalled&&(this.ad.strRichFlash!="")){strName=this.myName(strRichFlashName);}else {if(this.fImageOnly||this.objType==1){strName=this.myName(strImageName);}else if(this.ad.strDefaultFlash!=""){strName=this.myName(strFlashObjName);}}return this.adTI.getDoc().getElementById(strName);}function replay(){try{if(!this.fRichFlashPlayed)return;var bannerRes=this.getBannerRes();var container=bannerRes.parentNode;this.replayRes(bannerRes,this.ad.strRichFlash,false);}catch(e){}}function checkElementId(elemId){var bannerElemId=gEbBC.isIE()?this.getBannerRes().id:this.getBannerRes().parentNode.id;return (bannerElemId==elemId);}function switchToRich(objRef){var strName=(objRef.objType==1)?objRef.myName(strImageName):objRef.myName(strFlashObjName);var objToReplace=objRef.adTI.getDoc().getElementById(strName);var newObj=objRef.getBannerRes();strName=objRef.myName(strBannerDiv);var container=objRef.adTI.getDoc().getElementById(strName);objRef.replaceRes(newObj,objToReplace,container);}function displayImage(objRef){var strName=objRef.myName(strImageName);var imgAttr=new ebCTIObj(strName);if(objRef.ad.fLink)imgAttr.onclick=objRef.scriptWin+"." + objRef.objName + ".ebinteractionHandler('ebDefaultClick')";imgAttr.width=objRef.adData.nWidth;imgAttr.height=objRef.adData.nHeight;imgAttr.src=objRef.ad.strDefaultImage;imgAttr.containerStyle.display="inline";strName=objRef.myName(strBannerDiv);imgAttr.refElement=objRef.adTI.getDoc().getElementById(strName);objRef.adTI.addImage("append",imgAttr);gEbTI.addEventHandler("mouseover","ebOnMouseOverAd",imgAttr.refElement);gEbTI.addEventHandler("mouseout","ebOnMouseOutOfAd",imgAttr.refElement);}function addFlash(objRef,method,name,src,play,wmode,width,height){var flashVer=objRef.ad.flFlashVer;var objName=objRef.myName(name);if((typeof(width)=='undefined')||(typeof(height) == 'undefined')){width=objRef.adData.nWidth;height=objRef.adData.nHeight;}var flashAttr=new ebCTIObj(objName);flashAttr.src=src;flashAttr.version=flashVer;flashAttr.play=play;flashAttr.wmode=wmode;if(objRef.adData.strWmode!=""){var wmode=objRef.adData.strWmode.toLowerCase();if((wmode=="transparent")||(wmode == "window")||(wmode == "opaque"))flashAttr.wmode=wmode;}flashAttr.style.width=width+"px";flashAttr.style.height=height+"px";flashAttr.containerStyle.width=width+"px";flashAttr.containerStyle.height=height+"px";flashAttr.containerStyle.display="inline";if(gEbFlashVer>=6)flashAttr.flashVars=objRef.buildFlashVars(flashAttr.name);var fsCommandhandler=objRef.scriptWin+"." + objRef.objName + ".handleFSCommand(command,args,'" + flashAttr.name + "');";objRef.adTI.addFsCommandHandler(method,objName,fsCommandhandler);var objName=objRef.myName(strBannerDiv);var bannerDiv=flashAttr.refElement=objRef.adTI.getDoc().getElementById(objName);var flashObj=objRef.adTI.addFlash(method,flashAttr);gEbTI.addEventHandler("mouseover","ebOnMouseOverAd",flashObj.parentNode);gEbTI.addEventHandler("mouseout","ebOnMouseOutOfAd",flashObj.parentNode);return flashObj;}}if(!gfEbInIframe){if(typeof(gnEbBannerWasLoaded)=="undefined")gnEbBannerWasLoaded=1;else gnEbBannerWasLoaded++;if(typeof(ebDoOnBannerScriptLoad)=="function")ebDoOnBannerScriptLoad();}